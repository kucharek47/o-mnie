<div class="main">

  <div class="wysuwane" [class.otwarte]="wysuwane_otwarte()">
    <div class="slownik">
      <h3>Spisz</h3>
      @for (kat of kategorie(); track kat.nazwa) {
        <div class="slownik-lista">
          <div class="slownik-naglowki" (click)="aktywna_kategoria.set(kat === aktywna_kategoria() ? null : kat)">
            {{ kat.nazwa }}
            <span class="strzalka">{{ kat === aktywna_kategoria() ? "▼" : "▶" }}</span>
          </div>

          @if (kat === aktywna_kategoria()) {
            <div class="slownik-podlista">
              @for (proj of kat.projekty; track proj.tytul) {
                <div class="podlista-item" (click)="widok.set('projekty'); index.set($index); wysuwane_otwarte.set(false)">
                  {{ proj.tytul }}
                </div>
              }
            </div>
          }
        </div>
      }
    </div>
  </div>

  <div class="glowne" (touchstart)="onTouchStart($event)" (touchend)="onTouchEnd($event)">

    <div class="pasek_gora">
      <div class="lewo">
        <button mat-button class="btn-plan mobile-only" (click)="wl_wyl()">
          <mat-icon>menu</mat-icon> Plan
        </button>

        @if (widok() === 'projekty') {
          <button mat-button class="btn-cofnij desktop-only" (click)="cofnij()">
            <mat-icon>arrow_back</mat-icon> Cofnij
          </button>
        }
      </div>

      <div class="prawo">
        @if (widok() === 'projekty') {
          <button mat-button class="btn-cofnij mobile-only" (click)="cofnij()">
            Cofnij <mat-icon>arrow_forward</mat-icon>
          </button>
        }
      </div>
    </div>

    <div class="sterowanie">
      <button class="boczne-przyciski prev" (click)="przesuniecie(-1)">❮</button>

      <div class="karuzela-pole">
        @let elementy = elementy_rotacji();
        @let m = index();
        @let poprzednie = (m - 1 + elementy.length) % elementy.length;
        @let nastepne = (m + 1) % elementy.length;

        <div class="karta boczna lewa desktop-only"
             (click)="przesuniecie(-1)">
          <img [src]="zdj_slownik(elementy[poprzednie])" alt="">
        </div>

        <div class="karta glowna" (click)="wejdz_w()">
          <div class="ramka">
            <img [src]="zdj_slownik(elementy[m])" alt="Główny">
          </div>
          <div class="tytul-dol">{{ tytul_slownik(elementy[m]) }}</div>
        </div>

        <div class="karta boczna prawa desktop-only"
             (click)="przesuniecie(1)">
          <img [src]="zdj_slownik(elementy[nastepne])" alt="">
        </div>
      </div>

      <button class="boczne-przyciski next" (click)="przesuniecie(1)">❯</button>
    </div>

    <div class="opis">
      <div class="opis-ramka">
        @let elem = wybrany_element();
        @if (elem) {
          <h2>{{ tytul_slownik(elem) }}</h2>

          <p [innerHTML]="formatuj_tekst(opis_slownik(elem))"></p>

          @if (url_slownik(elem)) {
          }
        }
      </div>
    </div>

  </div>

  @if (wysuwane_otwarte()) {
    <div class="tlo" (click)="wysuwane_otwarte.set(false)"></div>
  }

  @if (okno_otwarte()) {
    <app-wyskakujace-url
      [linki]="dostepneLinki()"
      (zamknij)="okno_otwarte.set(false)">
    </app-wyskakujace-url>
  }
